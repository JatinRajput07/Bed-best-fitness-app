import{b as T,V as _,u as b,r as l,M as w,Z as H,j as s,a,$ as L,_ as M}from"./index-4e0354f5.js";import{S as y}from"./react-select.esm-ce3ab631.js";import"./assertThisInitialized-b01dd5f6.js";const D=()=>{const n=T(),v=_(),{users:i,loading:N,error:S}=b(e=>e.users),{assignments:u=[],loading:C,error:U}=b(e=>e.assignments),[o,g]=l.useState(null),[c,x]=l.useState([]),[m,p]=l.useState(null),[r,h]=l.useState({});l.useEffect(()=>{n(w({})),n(H())},[n]);const E=i.filter(e=>e.role==="host"),O=l.useMemo(()=>{const e=u.flatMap(t=>t.assignedUsers.map(d=>d.userId)||[]);return i.filter(t=>!e.includes(t._id)&&t.role==="user")},[u,i]).map(e=>({value:e._id,label:e.name?e.name:e.email,email:e.email})),f=E.map(e=>({value:e._id,label:e.name,email:e.email})),j=({data:e,innerRef:t,innerProps:d})=>s.jsx("div",{ref:t,...d,className:"flex items-center p-2 hover:bg-gray-100 cursor-pointer",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium text-gray-800",children:[e.label," "]}),e.email&&s.jsx("span",{className:"text-sm text-gray-500",children:e.email})]})}),k=()=>{const e={};return o||(e.host="Host is required."),c.length===0&&(e.users="At least one user is required."),h(e),Object.keys(e).length===0},A=()=>{if(!k())return;const e=new FormData;e.append("host",o),c.forEach(t=>{e.append("asign_user[]",t.value)}),e.append("image",m),n(L(e)).then(t=>{t.meta.requestStatus==="fulfilled"&&(M.success("success"),v("/dashboard/assign-users-list"),g(null),x([]),p(null),h({}))})};return N||C?s.jsx(a.Typography,{className:"text-center mt-6",children:"Loading..."}):S||U?s.jsx(a.Typography,{className:"text-center mt-6 text-red-500",children:"Error loading data. Please try again."}):s.jsx("div",{className:"mt-12 mb-8 flex flex-col gap-12",children:s.jsxs(a.Card,{children:[s.jsx(a.CardHeader,{variant:"gradient",color:"gray",className:"mb-4 p-6",children:s.jsx(a.Typography,{variant:"h6",color:"white",children:"Create Assignment"})}),s.jsxs(a.CardBody,{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Host"}),s.jsx(y,{options:f,value:f.find(e=>e.value===o),onChange:e=>g((e==null?void 0:e.value)||null),components:{Option:j},placeholder:"Select a host",className:"react-select-container",classNamePrefix:"react-select"}),r.host&&s.jsx(a.Typography,{color:"red",className:"text-sm mt-1",children:r.host})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Users"}),s.jsx(y,{isMulti:!0,options:O,value:c,onChange:e=>x(e||[]),components:{Option:j},placeholder:"Select users",className:"react-select-container",classNamePrefix:"react-select"}),r.users&&s.jsx(a.Typography,{color:"red",className:"text-sm mt-1",children:r.users})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Image"}),s.jsx("input",{type:"file",accept:"image/*",onChange:e=>p(e.target.files[0]),className:`block w-full text-sm text-gray-500\r
                file:mr-4 file:py-2 file:px-4\r
                file:rounded-full file:border-0\r
                file:text-sm file:font-semibold\r
                file:bg-blue-50 file:text-blue-700\r
                hover:file:bg-blue-100`}),r.image&&s.jsx(a.Typography,{color:"red",className:"text-sm mt-1",children:r.image}),m&&s.jsx("div",{className:"mt-4",children:s.jsx("img",{src:URL.createObjectURL(m),alt:"Preview",className:"w-32 h-32 object-cover rounded"})})]}),s.jsx(a.Button,{color:"blue",onClick:A,children:"Create Assignment"})]})]})})};export{D as default};
