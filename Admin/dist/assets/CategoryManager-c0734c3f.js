import{r,A as S,_ as o,j as e,a as t}from"./index-ae902f8e.js";const $=()=>{const[v,A]=r.useState([]),[E,c]=r.useState(!1),[s,n]=r.useState(""),[g,u]=r.useState(""),[h,m]=r.useState(""),[y,x]=r.useState(""),[D,p]=r.useState(null),[_,i]=r.useState(!1),[j,C]=r.useState(""),[B,k]=r.useState({id:null,isCategory:!0});r.useEffect(()=>{b()},[]);const b=()=>{S.get("/admin/categories").then(a=>{a.data.status==="success"?A(a.data.data):o.error("Failed to fetch categories.")}).catch(()=>{o.error("Error fetching categories.")})},I=()=>{if(s==="add-category"&&(!g||!j)){o.error("Category name and type are required.");return}if(s==="add-subcategory"&&(!h||!y)){o.error("Subcategory name and parent category are required.");return}const a=s==="add-category"?"/admin/categories":s==="add-subcategory"?"/admin/subcategories":s==="edit-category"?`/admin/categories/${D}`:`/admin/subcategories/${D}`,d=s==="add-category"||s==="edit-category"?{name:g,type:j}:{name:h,categoryId:y},l=s.startsWith("add")?"post":"patch";S[l](a,d).then(f=>{f.data.status==="success"?(o.success(`${s.startsWith("add")?s==="add-category"?"Category":"Subcategory":s==="edit-category"?"Category":"Subcategory"} ${s.startsWith("add")?"added":"updated"} successfully.`),b(),N()):o.error("Failed to save changes.")}).catch(()=>{o.error("Error saving changes.")})},T=()=>{const{id:a,isCategory:d}=B;if(!a)return;const l=d?`/admin/categories/${a}`:`/admin/subcategories/${a}`;S.delete(l).then(f=>{f.data.status==="success"?(o.success(`${d?"Category":"Subcategory"} deleted successfully.`),b()):o.error("Failed to delete."),i(!1)}).catch(()=>{o.error("Error deleting."),i(!1)})},w=(a,d=!0)=>{k({id:a,isCategory:d}),i(!0)},N=()=>{c(!1),u(""),m(""),x(""),C(""),n(""),p(null)};return e.jsxs("div",{className:"mt-12 mb-8 flex justify-center",children:[e.jsxs(t.Card,{className:"w-full max-w-6xl shadow-lg",children:[e.jsx(t.CardHeader,{className:"bg-gradient-to-r from-green-600 to-blue-600 p-6 rounded-t-lg flex justify-between items-center",children:e.jsx(t.Typography,{variant:"h5",color:"white",children:"Category Manager"})}),e.jsxs(t.CardBody,{children:[e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx(t.Button,{color:"lightBlue",onClick:()=>{n("add-category"),c(!0)},children:"Add Category"}),e.jsx(t.Button,{color:"lightGreen",onClick:()=>{n("add-subcategory"),c(!0)},children:"Add Subcategory"})]}),e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"px-6 py-2",children:"S.No"}),e.jsx("th",{className:"px-6 py-2",children:"Category"}),e.jsx("th",{className:"px-6 py-2",children:"Subcategories"}),e.jsx("th",{className:"px-6 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:v.map((a,d)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-6 py-2",children:d+1}),e.jsxs("td",{className:"px-6 py-2",children:[a.name," "]}),e.jsx("td",{className:"px-6 py-2",children:a.subcategories.length>0?e.jsx("ul",{children:a.subcategories.map(l=>e.jsxs("li",{className:"flex justify-between",children:[l.name,e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx(t.Button,{size:"sm",color:"green",className:"p-1",onClick:()=>{n("edit-subcategory"),p(l._id),m(l.name),x(a._id),c(!0)},children:"Edit"}),e.jsx(t.Button,{size:"sm",className:"p-1",color:"red",onClick:()=>w(l._id,!1),children:"Delete"})]})]},l._id))}):"No subcategories"}),e.jsxs("td",{className:"px-6 py-2",children:[e.jsx(t.Button,{color:"green",className:"p-2 mr-1",onClick:()=>{n("edit-category"),p(a._id),u(a.name),C(a.type),c(!0)},children:"Edit"}),e.jsx(t.Button,{className:"p-2",color:"red",onClick:()=>w(a._id),children:"Delete"})]})]},a._id))})]})]})]}),e.jsxs(t.Dialog,{open:E,handler:N,children:[e.jsxs(t.DialogBody,{children:[e.jsx(t.Typography,{variant:"h6",className:"mb-4 text-center",children:s==="add-category"||s==="edit-category"?s==="add-category"?"Add New Category":"Edit Category":s==="add-subcategory"?"Add New Subcategory":"Edit Subcategory"}),s==="add-category"||s==="edit-category"?e.jsxs(e.Fragment,{children:[e.jsx(t.Input,{label:"Category Name",value:g,onChange:a=>u(a.target.value),className:"mb-4"}),e.jsxs("select",{className:"border rounded mt-4 p-2 w-full mb-4",value:j,onChange:a=>C(a.target.value),children:[e.jsx("option",{value:"",children:"Select Category Type"}),e.jsx("option",{value:"audio",children:"Audio"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"image",children:"Image"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(t.Input,{label:"Subcategory Name",value:h,onChange:a=>m(a.target.value),className:"mb-4"}),e.jsxs("select",{className:"border rounded mt-4 p-2 w-full mb-4",value:y,onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"",children:"Select Parent Category"}),v.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]})]}),e.jsxs(t.DialogFooter,{className:"gap-2",children:[e.jsx(t.Button,{className:"",color:"red",onClick:N,children:"Cancel"}),e.jsx(t.Button,{color:"green",onClick:I,children:s.startsWith("add")?"Add":"Update"})]})]}),e.jsxs(t.Dialog,{open:_,handler:()=>i(!1),children:[e.jsx(t.DialogBody,{children:e.jsxs(t.Typography,{variant:"h6",className:"mb-4 text-center",children:["Are you sure you want to delete this ",B.isCategory?"category":"subcategory","?"]})}),e.jsxs(t.DialogFooter,{className:"gap-2 justify-center",children:[e.jsx(t.Button,{color:"red",onClick:()=>i(!1),children:"Cancel"}),e.jsx(t.Button,{color:"green",onClick:T,children:"Confirm"})]})]})]})};export{$ as default};
