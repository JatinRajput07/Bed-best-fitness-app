import{b as w,u as A,r as u,a4 as x,j as e,a,a6 as T,a7 as C,_ as i,a8 as I}from"./index-2454d538.js";import{T as D}from"./TrashIcon-6269cbab.js";const S=()=>{const l=w(),{assignments:y,loading:j,error:p}=A(t=>t.assignments),h=u.useRef({});u.useEffect(()=>{l(x())},[l]);const N=(t,r,n)=>{window.confirm("Are you sure you want to proceed?")&&l(C({id:t,type:r,userId:n})).then(s=>{s.meta.requestStatus==="fulfilled"&&(l(x()),i.success("Assignment deleted successfully!"))}).catch(s=>{i.error("Failed to delete assignment."),console.error("Delete error:",s)})},b=(t,r)=>{const n=t.target.files[0];if(!n){i.error("No image selected.");return}const s=new FormData;s.append("image",n),l(I({assignmentId:r,imageData:s})).then(c=>{c.meta.requestStatus==="fulfilled"&&(i.success("Image uploaded successfully!"),l(x()))}).catch(c=>{i.error("Image upload failed."),console.error("Image upload error:",c)})};return j?e.jsx(a.Typography,{className:"text-center mt-6",children:"Loading..."}):p?e.jsxs(a.Typography,{className:"text-center mt-6 text-red-500",children:["Error: ",p]}):e.jsxs("div",{className:"mt-12 mb-8 flex flex-col gap-8",children:[e.jsx(a.CardHeader,{variant:"gradient",color:"gray",className:"p-6",children:e.jsx(a.Typography,{variant:"h6",color:"white",children:"Assign Users List"})}),y.map(({_id:t,hostName:r,hostEmail:n,assignedUsers:s})=>e.jsxs(a.Card,{className:"w-full mx-auto shadow-lg",children:[e.jsx(a.CardHeader,{color:"transparent",className:"p-4 flex items-center justify-between border-b border-blue-gray-50 rounded-none",floated:!1,shadow:!1,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(a.Avatar,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random&color=fff`,alt:r,size:"lg"}),e.jsxs("div",{children:[e.jsx(a.Typography,{variant:"h6",color:"blue-gray",children:r}),e.jsx(a.Typography,{variant:"small",color:"gray",className:"font-normal",children:n})]})]})}),e.jsxs(a.CardBody,{className:"p-4",children:[e.jsxs(a.Typography,{variant:"small",color:"blue-gray",className:"font-semibold mb-3 flex items-center gap-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{fillRule:"evenodd",d:"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z",clipRule:"evenodd"})}),"Assigned Users (",s.length,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"px-4 py-2 text-left text-gray-700 font-semibold text-sm",children:"User"}),e.jsx("th",{className:"px-4 py-2 text-left text-gray-700 font-semibold text-sm",children:"Email"}),e.jsx("th",{className:"px-4 py-2 text-left text-gray-700 font-semibold text-sm",children:"Assignment Image"}),e.jsx("th",{className:"px-4 py-2 text-center text-gray-700 font-semibold text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(({userId:c,name:m,email:v,imageUrl:g,assignedAt:R},f)=>{const d=`${t}-${c}`;return e.jsxs("tr",{className:f%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a.Avatar,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(m)}&background=random&color=fff`,alt:m,size:"sm"}),e.jsx(a.Typography,{variant:"small",color:"blue-gray",className:"font-semibold",children:m})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(a.Typography,{variant:"small",color:"gray",className:"font-normal",children:v})}),e.jsx("td",{className:"px-4 py-3",children:g?e.jsx("img",{src:g,alt:"Assignment",className:"h-12 w-12 object-cover rounded-md"}):e.jsx(a.Typography,{variant:"small",color:"gray",className:"font-normal",children:"No image"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs(a.Button,{variant:"outlined",size:"sm",className:"py-1 px-3 text-xs flex items-center gap-1",onClick:()=>{var o;return(o=h.current[d])==null?void 0:o.click()},children:[e.jsx(T,{className:"h-4 w-4"}),"Upload Image"]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:o=>h.current[d]=o,onChange:o=>b(o,s[f]._id)}),e.jsx(a.Button,{variant:"text",color:"red",size:"sm",className:"rounded-full p-2",onClick:()=>N(t,"user",c),children:e.jsx(D,{className:"h-4 w-4"})})]})})]},d)})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 text-sm text-gray-500 border-t border-blue-gray-50 pt-3",children:[e.jsxs(a.Typography,{variant:"small",color:"gray",className:"font-normal",children:["Created:"," ",s.length>0?new Date(s[0].assignedAt).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"}):"N/A"]}),e.jsxs(a.Typography,{variant:"small",color:"gray",className:"font-normal",children:[s.length," users"]})]})]})]},t))]})};export{S as default};
