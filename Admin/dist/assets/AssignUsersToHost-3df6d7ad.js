import{z as O,K as _,u as f,r,D as H,Q as T,j as s,a as t,S as k,_ as M}from"./index-9ec13ec2.js";import{S as j}from"./react-select.esm-cb86f55c.js";import"./assertThisInitialized-57b314dc.js";const D=()=>{const n=O(),y=_(),{users:o,loading:v,error:N}=f(e=>e.users),{assignments:d=[],loading:b,error:S}=f(e=>e.assignments),[i,u]=r.useState(null),[c,h]=r.useState([]),[l,g]=r.useState({});r.useEffect(()=>{n(H({})),n(T())},[n]);const C=o.filter(e=>e.role==="host"),E=r.useMemo(()=>{const e=d.flatMap(a=>a.assignedUsers.map(m=>m.userId)||[]);return o.filter(a=>!e.includes(a._id)&&a.role==="user")},[d,o]).map(e=>({value:e._id,label:e.name?e.name:e.email,email:e.email})),x=C.map(e=>({value:e._id,label:e.name,email:e.email})),p=({data:e,innerRef:a,innerProps:m})=>s.jsx("div",{ref:a,...m,className:"flex items-center p-2 hover:bg-gray-100 cursor-pointer",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium text-gray-800",children:[e.label," "]}),e.email&&s.jsx("span",{className:"text-sm text-gray-500",children:e.email})]})}),U=()=>{const e={};return i||(e.host="Host is required."),c.length===0&&(e.users="At least one user is required."),g(e),Object.keys(e).length===0},A=()=>{U()&&n(k({host:i,asign_user:c.map(e=>e.value)})).then(e=>{e.meta.requestStatus==="fulfilled"&&(M.success("success"),y("/dashboard/assign-users-list"),u(null),h([]),g({}))})};return v||b?s.jsx(t.Typography,{className:"text-center mt-6",children:"Loading..."}):N||S?s.jsx(t.Typography,{className:"text-center mt-6 text-red-500",children:"Error loading data. Please try again."}):s.jsx("div",{className:"mt-12 mb-8 flex flex-col gap-12",children:s.jsxs(t.Card,{children:[s.jsx(t.CardHeader,{variant:"gradient",color:"gray",className:"mb-4 p-6",children:s.jsx(t.Typography,{variant:"h6",color:"white",children:"Create Assignment"})}),s.jsxs(t.CardBody,{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Host"}),s.jsx(j,{options:x,value:x.find(e=>e.value===i),onChange:e=>u((e==null?void 0:e.value)||null),components:{Option:p},placeholder:"Select a host",className:"react-select-container",classNamePrefix:"react-select"}),l.host&&s.jsx(t.Typography,{color:"red",className:"text-sm mt-1",children:l.host})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Users"}),s.jsx(j,{isMulti:!0,options:E,value:c,onChange:e=>h(e||[]),components:{Option:p},placeholder:"Select users",className:"react-select-container",classNamePrefix:"react-select"}),l.users&&s.jsx(t.Typography,{color:"red",className:"text-sm mt-1",children:l.users})]}),s.jsx(t.Button,{color:"blue",onClick:A,children:"Create Assignment"})]})]})})};export{D as default};
