import{r as l,j as e,a as s,A as d}from"./index-3cb54544.js";import{S as F,N as V,P as _,a as $,b as q,D as G}from"./pagination-aecc7a2a.js";import{T as J,a as K,b as Q,c as S,d as W}from"./TableRow-61574550.js";import{T as t,a as X}from"./TablePagination-2736361f.js";import"./Paper-f1d6b2e6.js";import"./assertThisInitialized-82617317.js";const le=()=>{const[m,D]=l.useState([]),[u,p]=l.useState(null),[j,f]=l.useState(null),[P,v]=l.useState(!1),[k,b]=l.useState(!1),[T,w]=l.useState(null),[C,B]=l.useState(!1),[i,N]=l.useState(0),[r,A]=l.useState(5),[h,y]=l.useState(""),o=()=>{d.get("/admin/banner").then(a=>{a.data.status==="success"&&Array.isArray(a.data.data)&&D(a.data.data)}).catch(a=>console.error("Error fetching banners:",a))};l.useEffect(()=>{o()},[]);const I=a=>a.size>2097152?"Image size should be less than 2MB":null,R=a=>{const n=a.target.files[0];if(!n)return;const c=I(n);if(c){alert(c);return}p(n),f(URL.createObjectURL(n))},z=()=>v(!0),g=()=>{p(null),f(null),y(""),v(!1)},E=a=>{w(a),b(!0)},x=()=>{b(!1),w(null)},M=()=>{if(!u)return;B(!0);const a=new FormData;a.append("image",u),h&&a.append("link",h),d.post("/admin/banner",a).then(n=>{n.data.status==="success"&&(o(),g())}).catch(n=>console.error("Error creating banner:",n)).finally(()=>B(!1))},O=(a,n)=>{d.patch(`/admin/banner/${a}/status`,{isActive:!n}).then(()=>o()).catch(c=>console.error("Error toggling banner status:",c))},L=a=>{d.delete(`/admin/banner/${a}`).then(()=>{o(),x()}).catch(n=>console.error("Error deleting banner:",n))},H=(a,n)=>N(n),U=a=>{A(parseInt(a.target.value,10)),N(0)};return e.jsxs("div",{className:"mt-12 mb-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(s.Typography,{variant:"h5",className:"mb-4 font-bold text-center",children:"Active Banners"}),e.jsx(F,{navigation:!0,pagination:{clickable:!0},modules:[V,_],className:"h-64",children:m.filter(a=>a.isActive).map(a=>e.jsx($,{children:e.jsx("img",{src:a.imageUrl,alt:"Banner",className:"w-full h-full object-cover rounded-md"})},a._id))})]}),e.jsxs(s.Card,{className:"w-full shadow-lg",children:[e.jsxs(s.CardHeader,{className:"p-6 bg-blue-600 text-white flex justify-between",children:[e.jsx(s.Typography,{variant:"h5",children:"Banner Management"}),e.jsx(s.Button,{onClick:z,children:"Add Banner"})]}),e.jsxs(s.CardBody,{className:"p-6",children:[e.jsx(J,{children:e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs(S,{children:[e.jsx(t,{children:"Sr. No."}),e.jsx(t,{children:"Image"}),e.jsx(t,{children:"Link"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(W,{children:m.slice(i*r,i*r+r).map((a,n)=>e.jsxs(S,{children:[e.jsx(t,{children:i*r+n+1}),e.jsx(t,{children:e.jsx("img",{src:a.imageUrl,alt:"Banner",className:"w-32 h-32 object-cover rounded-md"})}),e.jsx(t,{children:(a==null?void 0:a.link)??"-"}),e.jsx(t,{children:e.jsx(q,{checked:a.isActive,onChange:()=>O(a._id,a.isActive)})}),e.jsx(t,{children:e.jsx(s.Button,{color:"red",onClick:()=>E(a._id),children:"Delete"})})]},a._id))})]})}),e.jsx(X,{rowsPerPageOptions:[5,10,25],component:"div",count:m.length,rowsPerPage:r,page:i,onPageChange:H,onRowsPerPageChange:U})]})]}),e.jsxs(s.Dialog,{open:P,handler:g,children:[e.jsxs(s.DialogBody,{className:"flex flex-col items-center p-6",children:[e.jsx(s.Typography,{variant:"h4",className:"mb-6 font-semibold",children:"Add New Banner"}),e.jsxs("div",{className:"mb-4 w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Banner Image (Recommended: 1920x768px, 5:2 ratio, Max: 2MB)"}),e.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-400 rounded-lg p-4",children:[e.jsx("input",{type:"file",id:"image-upload",className:"hidden",onChange:R,accept:"image/*","max-size":"2097152"}),e.jsx("label",{htmlFor:"image-upload",className:"cursor-pointer w-full",children:j?e.jsx("div",{className:"relative w-full",style:{paddingTop:"40%"},children:e.jsx("img",{src:j,alt:"Banner Preview",className:"absolute top-0 left-0 w-full h-full object-cover rounded-lg"})}):e.jsxs("div",{className:"flex flex-col items-center py-8",children:[e.jsx("span",{className:"text-4xl text-primary",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-10 h-10",children:e.jsx("path",{fillRule:"evenodd",d:"M7 4a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v1h2a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2V4zm1 2v1h8V6H8zm-2 3v8h12V9H6zm6 1a3 3 0 1 1 0 6 3 3 0 0 1 0-6z",clipRule:"evenodd"})})}),e.jsx(s.Typography,{variant:"small",className:"mt-2 text-gray-600",children:"Select Image (1920x768px recommended, max 2MB)"})]})})]})]}),e.jsx(s.Input,{label:"Link (Optional)",value:h,onChange:a=>y(a.target.value),className:"mb-4 w-full"})]}),e.jsxs(s.DialogFooter,{className:"p-6",children:[e.jsx(s.Button,{onClick:g,color:"red",variant:"text",className:"mr-2",children:"Cancel"}),e.jsx(s.Button,{onClick:M,color:"green",disabled:C,children:C?"Uploading...":"Submit"})]})]}),e.jsxs(G,{open:k,onClose:x,children:[e.jsx(s.DialogBody,{children:e.jsx(s.Typography,{children:"Are you sure you want to delete this banner?"})}),e.jsxs(s.DialogFooter,{children:[e.jsx(s.Button,{onClick:x,color:"red",children:"Cancel"}),e.jsx(s.Button,{onClick:()=>L(T),color:"green",children:"Delete"})]})]})]})};export{le as default};
