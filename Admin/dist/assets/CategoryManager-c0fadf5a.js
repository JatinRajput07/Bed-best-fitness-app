import{r as o,l as h,Z as a,j as e,a as s}from"./index-119d8804.js";const A=()=>{const[y,C]=o.useState([]),[j,m]=o.useState(!1),[r,N]=o.useState("add"),[d,x]=o.useState(""),[l,p]=o.useState(""),[n,f]=o.useState(""),[b,S]=o.useState(null);o.useEffect(()=>{i()},[]);const i=()=>{h.get("http://43.204.2.84:7200/admin/categories").then(t=>{t.data.status==="success"?C(t.data.data):a.error("Failed to fetch categories.")}).catch(()=>{a.error("Error fetching categories.")})},v=()=>{if(!d){a.error("Category name is required.");return}h.post("http://43.204.2.84:7200/admin/categories",{name:d}).then(t=>{t.data.status==="success"?(a.success("Category added successfully."),i(),u()):a.error("Failed to add category.")}).catch(()=>{a.error("Error adding category.")})},D=()=>{if(!l||!n){a.error("Subcategory name and parent category are required.");return}h.post("http://43.204.2.84:7200/admin/subcategories",{name:l,categoryId:n}).then(t=>{t.data.status==="success"?(a.success("Subcategory added successfully."),i(),u()):a.error("Failed to add subcategory.")}).catch(()=>{a.error("Error adding subcategory.")})},E=()=>{if(r==="edit-category"&&!d){a.error("Category name is required.");return}if(r==="edit-subcategory"&&(!l||!n)){a.error("Subcategory name and parent category are required.");return}const t=r==="edit-category"?`http://43.204.2.84:7200/admin/categories/${b}`:`http://43.204.2.84:7200/admin/subcategories/${b}`,c=r==="edit-category"?{name:d}:{name:l,categoryId:n};h.patch(t,c).then(g=>{g.data.status==="success"?(a.success(`${r==="edit-category"?"Category":"Subcategory"} updated successfully.`),i(),u()):a.error("Failed to update.")}).catch(()=>{a.error("Error updating.")})},I=(t,c=!0)=>{const g=c?`http://43.204.2.84:7200/admin/categories/${t}`:`http://43.204.2.84:7200/admin/subcategories/${t}`;h.delete(g).then(w=>{w.data.status==="success"?(a.success(`${c?"Category":"Subcategory"} deleted successfully.`),i()):a.error("Failed to delete.")}).catch(()=>{a.error("Error deleting.")})},u=()=>{m(!1),x(""),p(""),f(""),N("add"),S(null)};return e.jsxs("div",{className:"mt-12 mb-8 flex justify-center",children:[e.jsxs(s.Card,{className:"w-full max-w-6xl shadow-lg",children:[e.jsxs(s.CardHeader,{variant:"gradient",className:"bg-gradient-to-r from-green-600 to-blue-600 p-6 rounded-t-lg flex justify-between items-center",children:[e.jsx(s.Typography,{variant:"h5",color:"white",children:"Category Manager"}),e.jsx(s.Button,{color:"lightBlue",onClick:()=>m(!0),children:"Add Category/SubCategory"})]}),e.jsx(s.CardBody,{children:e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"px-6 py-2 text-left text-sm font-medium text-gray-700",children:"S.No"}),e.jsx("th",{className:"px-6 py-2 text-left text-sm font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"px-6 py-2 text-left text-sm font-medium text-gray-700",children:"SubCategories"}),e.jsx("th",{className:"px-6 py-2 text-left text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:y.map((t,c)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-6 py-2 text-sm text-gray-600",children:c+1}),e.jsx("td",{className:"px-6 py-2 text-sm text-gray-600",children:t.name}),e.jsx("td",{className:"px-6 py-2 text-sm text-gray-600",children:t.subcategories.length>0?t.subcategories.map(g=>g.name).join(", "):"No subcategories"}),e.jsx("td",{className:"px-6 py-2 text-sm text-gray-600",children:e.jsx(s.Button,{color:"red",onClick:()=>I(t._id),children:"Delete"})})]},t._id))})]})})]}),e.jsxs(s.Dialog,{open:j,handler:u,children:[e.jsx(s.DialogBody,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(s.Input,{label:"Category Name",value:d,onChange:t=>x(t.target.value),disabled:r==="edit-subcategory"}),e.jsx(s.Input,{label:"SubCategory Name",value:l,onChange:t=>p(t.target.value),disabled:r==="edit-category"}),e.jsxs("select",{className:"border rounded p-2 w-full",value:n,onChange:t=>f(t.target.value),disabled:r==="edit-category",children:[e.jsx("option",{value:"",children:"Select Parent Category"}),y.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]})}),e.jsxs(s.DialogFooter,{children:[e.jsx(s.Button,{color:"red",onClick:u,children:"Cancel"}),e.jsx(s.Button,{color:"green",onClick:r.startsWith("edit")?E:d?v:D,children:r.startsWith("edit")?"Update":d?"Add Category":"Add SubCategory"})]})]})]})};export{A as default};
