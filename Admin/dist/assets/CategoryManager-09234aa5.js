import{r,A as b,_ as o,j as e,a as t}from"./index-aded11a1.js";const $=()=>{const[f,B]=r.useState([]),[A,n]=r.useState(!1),[s,i]=r.useState(""),[g,N]=r.useState(""),[u,h]=r.useState(""),[y,m]=r.useState(""),[S,v]=r.useState(null),[E,c]=r.useState(!1),[x,D]=r.useState(""),[w,_]=r.useState({id:null,isCategory:!0});r.useEffect(()=>{p()},[]);const p=()=>{b.get("/admin/categories").then(a=>{a.data.status==="success"?B(a.data.data):o.error("Failed to fetch categories.")}).catch(()=>{o.error("Error fetching categories.")})},k=()=>{if(s==="add-category"&&(!g||!x)){o.error("Category name and type are required.");return}if(s==="add-subcategory"&&(!u||!y)){o.error("Subcategory name and parent category are required.");return}const a=s==="add-category"?"/admin/categories":s==="add-subcategory"?"/admin/subcategories":s==="edit-category"?`/admin/categories/${S}`:`/admin/subcategories/${S}`,l=s==="add-category"||s==="edit-category"?{name:g,type:x}:{name:u,categoryId:y},d=s.startsWith("add")?"post":"patch";b[d](a,l).then(C=>{C.data.status==="success"?(o.success(`${s.startsWith("add")?s==="add-category"?"Category":"Subcategory":s==="edit-category"?"Category":"Subcategory"} ${s.startsWith("add")?"added":"updated"} successfully.`),p(),j()):o.error("Failed to save changes.")}).catch(()=>{o.error("Error saving changes.")})},I=()=>{const{id:a,isCategory:l}=w;if(!a)return;const d=l?`/admin/categories/${a}`:`/admin/subcategories/${a}`;b.delete(d).then(C=>{C.data.status==="success"?(o.success(`${l?"Category":"Subcategory"} deleted successfully.`),p()):o.error("Failed to delete."),c(!1)}).catch(()=>{o.error("Error deleting."),c(!1)})},T=(a,l=!0)=>{_({id:a,isCategory:l}),c(!0)},j=()=>{n(!1),N(""),h(""),m(""),D(""),i(""),v(null)};return e.jsxs("div",{className:"mt-12 mb-8 flex justify-center",children:[e.jsxs(t.Card,{className:"w-full max-w-6xl shadow-lg",children:[e.jsx(t.CardHeader,{className:"bg-gradient-to-r from-green-600 to-blue-600 p-6 rounded-t-lg flex justify-between items-center",children:e.jsx(t.Typography,{variant:"h5",color:"white",children:"Category Manager"})}),e.jsxs(t.CardBody,{children:[e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx(t.Button,{color:"lightBlue",onClick:()=>{i("add-category"),n(!0)},children:"Add Category"}),e.jsx(t.Button,{color:"lightGreen",onClick:()=>{i("add-subcategory"),n(!0)},children:"Add Subcategory"})]}),e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"px-6 py-2",children:"S.No"}),e.jsx("th",{className:"px-6 py-2",children:"Category"}),e.jsx("th",{className:"px-6 py-2",children:"Subcategories"})]})}),e.jsx("tbody",{children:f.map((a,l)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-6 py-2",children:l+1}),e.jsxs("td",{className:"px-6 py-2",children:[a.name," "]}),e.jsx("td",{className:"px-6 py-2",children:a.subcategories.length>0?e.jsx("ul",{children:a.subcategories.map(d=>e.jsxs("li",{className:"flex justify-between",children:[d.name,e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx(t.Button,{size:"sm",color:"green",className:"p-1",onClick:()=>{i("edit-subcategory"),v(d._id),h(d.name),m(a._id),n(!0)},children:"Edit"}),e.jsx(t.Button,{size:"sm",className:"p-1",color:"red",onClick:()=>T(d._id,!1),children:"Delete"})]})]},d._id))}):"No subcategories"})]},a._id))})]})]})]}),e.jsxs(t.Dialog,{open:A,handler:j,children:[e.jsxs(t.DialogBody,{children:[e.jsx(t.Typography,{variant:"h6",className:"mb-4 text-center",children:s==="add-category"||s==="edit-category"?s==="add-category"?"Add New Category":"Edit Category":s==="add-subcategory"?"Add New Subcategory":"Edit Subcategory"}),s==="add-category"||s==="edit-category"?e.jsxs(e.Fragment,{children:[e.jsx(t.Input,{label:"Category Name",value:g,onChange:a=>N(a.target.value),className:"mb-4"}),e.jsxs("select",{className:"border rounded mt-4 p-2 w-full mb-4",value:x,onChange:a=>D(a.target.value),children:[e.jsx("option",{value:"",children:"Select Category Type"}),e.jsx("option",{value:"audio",children:"Audio"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"image",children:"Image"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(t.Input,{label:"Subcategory Name",value:u,onChange:a=>h(a.target.value),className:"mb-4"}),e.jsxs("select",{className:"border rounded mt-4 p-2 w-full mb-4",value:y,onChange:a=>m(a.target.value),children:[e.jsx("option",{value:"",children:"Select Parent Category"}),f.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]})]}),e.jsxs(t.DialogFooter,{className:"gap-2",children:[e.jsx(t.Button,{className:"",color:"red",onClick:j,children:"Cancel"}),e.jsx(t.Button,{color:"green",onClick:k,children:s.startsWith("add")?"Add":"Update"})]})]}),e.jsxs(t.Dialog,{open:E,handler:()=>c(!1),children:[e.jsx(t.DialogBody,{children:e.jsxs(t.Typography,{variant:"h6",className:"mb-4 text-center",children:["Are you sure you want to delete this ",w.isCategory?"category":"subcategory","?"]})}),e.jsxs(t.DialogFooter,{className:"gap-2 justify-center",children:[e.jsx(t.Button,{color:"red",onClick:()=>c(!1),children:"Cancel"}),e.jsx(t.Button,{color:"green",onClick:I,children:"Confirm"})]})]})]})};export{$ as default};
