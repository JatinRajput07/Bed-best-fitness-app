import{y as A,z as f,r,D as O,Q as H,j as s,a as t,S as T}from"./index-611eecad.js";import{S as j}from"./react-select.esm-84d785ed.js";import"./assertThisInitialized-a157bb13.js";const P=()=>{const n=A(),{users:o,loading:y,error:N}=f(e=>e.users),{assignments:d=[],loading:v,error:b}=f(e=>e.assignments),[c,u]=r.useState(null),[i,h]=r.useState([]),[l,x]=r.useState({});r.useEffect(()=>{n(O({})),n(H())},[n]);const S=o.filter(e=>e.role==="host"),C=r.useMemo(()=>{const e=d.flatMap(a=>a.assignedUsers.map(m=>m.userId)||[]);return o.filter(a=>!e.includes(a._id)&&a.role==="user")},[d,o]).map(e=>({value:e._id,label:e.name?e.name:e.email,email:e.email})),p=S.map(e=>({value:e._id,label:e.name,email:e.email})),g=({data:e,innerRef:a,innerProps:m})=>s.jsx("div",{ref:a,...m,className:"flex items-center p-2 hover:bg-gray-100 cursor-pointer",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-medium text-gray-800",children:[e.label," "]}),e.email&&s.jsx("span",{className:"text-sm text-gray-500",children:e.email})]})}),E=()=>{const e={};return c||(e.host="Host is required."),i.length===0&&(e.users="At least one user is required."),x(e),Object.keys(e).length===0},U=()=>{E()&&(n(T({host:c,asign_user:i.map(e=>e.value)})),alert("Assignment created successfully!"),u(null),h([]),x({}))};return y||v?s.jsx(t.Typography,{className:"text-center mt-6",children:"Loading..."}):N||b?s.jsx(t.Typography,{className:"text-center mt-6 text-red-500",children:"Error loading data. Please try again."}):s.jsx("div",{className:"mt-12 mb-8 flex flex-col gap-12",children:s.jsxs(t.Card,{children:[s.jsx(t.CardHeader,{variant:"gradient",color:"gray",className:"mb-4 p-6",children:s.jsx(t.Typography,{variant:"h6",color:"white",children:"Create Assignment"})}),s.jsxs(t.CardBody,{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Host"}),s.jsx(j,{options:p,value:p.find(e=>e.value===c),onChange:e=>u((e==null?void 0:e.value)||null),components:{Option:g},placeholder:"Select a host",className:"react-select-container",classNamePrefix:"react-select"}),l.host&&s.jsx(t.Typography,{color:"red",className:"text-sm mt-1",children:l.host})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Users"}),s.jsx(j,{isMulti:!0,options:C,value:i,onChange:e=>h(e||[]),components:{Option:g},placeholder:"Select users",className:"react-select-container",classNamePrefix:"react-select"}),l.users&&s.jsx(t.Typography,{color:"red",className:"text-sm mt-1",children:l.users})]}),s.jsx(t.Button,{color:"blue",onClick:U,children:"Create Assignment"})]})]})})};export{P as default};
